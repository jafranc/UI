<?xml version="1.0"?>

<Problem>
  <Solvers>
    <CompositionalMultiphaseFVM
      name="compflow"
      logLevel="1"
      discretization="fluidTPFA"
      temperature="368.15"
      useMass="1"
      targetRegions="{ region }">
      <NonlinearSolverParameters
        newtonTol="1.0e-5"
        newtonMaxIter="100"
        maxTimeStepCuts="5"
        lineSearchAction="None"/>
      <LinearSolverParameters
        directParallel="0"/>
    </CompositionalMultiphaseFVM>
  </Solvers>

  <Mesh>
    <VTKMesh
      name="my_mesh"
      file="spe11a_relabeled_extruded.vtu"
      fieldsToImport="{ PORO, VOLUME }" />
  </Mesh>

  <Events
          maxTime="2e7">
    <PeriodicEvent
            name="outputs"
            timeFrequency="1e6"
            target="/Outputs/siloOutput"/>

    <PeriodicEvent
            name="solverApplications1"
            forceDt="1e4"
            endTime="1e5"
            target="/Solvers/compflow"/>

    <PeriodicEvent
            name="solverApplications2"
            forceDt="1e5"
            beginTime="1e5"
            target="/Solvers/compflow"/>

    <PeriodicEvent
            name="restarts"
            timeFrequency="1e7"
            targetExactTimestep="0"
            target="/Outputs/restartOutput"/>
  </Events>

  <Functions>
    <TableFunction
      name="waterRelPermTable"
      coordinates="{ 0.0, 0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35, 0.40, 0.45,
                     0.5, 0.55, 0.60, 0.65, 0.70, 0.75, 0.80, 0.85, 0.90, 0.95, 1.00 }"
      values="{ 0, 0.0025, 0.0100, 0.0225, 0.0400, 0.0625, 0.0900, 0.1225, 0.1600, 0.2025,
                0.2500, 0.3025, 0.3600, 0.4225, 0.4900, 0.5625, 0.6400, 0.7225, 0.8100, 0.9025, 1.0000 }"/>

    <TableFunction
      name="imbibitionGasRelativePermeabilityTable"
      coordinateFiles="{ tables/imbibitionPhaseVolFraction_gas.txt }"
      voxelFile="tables/imbibitionRelPerm_gas.txt"/>


  </Functions>

</Problem>
